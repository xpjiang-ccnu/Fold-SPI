# Fold-SPI: a structure-based protein language model for SEP-protein interaction prediction

Fold-SPI is a structure-based deep learning framework for multifaceted predictions of microprotein-protein interactions, including not only binary SEP-protein interactions, but also PPI predictions.

### Requirement
Trained and tested on a linux server with GeForce GTX 3080 and the running environment is as follows:<br />
```shell
biopython = 1.8.1
matplotlib = 3.7.1
numpy = 1.24.1
python = 3.8.13
pytorch = 1.13.1+cu117
scikit-learn
```
<br />
You can configure the conda environment with the following command:<br />

```shell
conda create -n fold_spi python=3.8.13 -y
conda activate fold_spi

# install pytorch
pip install torch==1.13.1+cu117 torchvision==0.14.1+cu117 torchaudio==0.13.1 --extra-index-url https://download.pytorch.org/whl/cu117

# install numpy & biopython & sklearn
pip install numpy==1.24.1
pip install biopython
pip install scikit-learn
```

### Running Fold-SPI

1.To predict with our example code, first unzip the test set by `unzip ./example/*.zip` and use the example data with the command:

```shell
python predict_Fold_SPI.py --feature_dir ./example/ --model_dir ./example/model_best.pkl --input_file ./example/test_split_by_SEP_1.txt --output_file Fold_SPI_preds_SEP_1.txt
```
View the results in the `./example/Fold_SPI_preds_SEP_1.txt` folder<br />

2.To generate yourself features, please refer to the instructuion in `Feature standardization`.<br />

3.We added `run_predict.sh` for users with no `Machine learing` background to easily predict SPIs using the Fold-SPI model. Just run the command `bash run_predict.sh`

### Feature standardization

- STEP 0: Here we offer the protocol to construct the benchmark dataset.  Due to the copyright issues, we can not provide the complete benchmark dataset. You can follow the procedure in the following steps to reproduce the baseline dataset and corresponding features (or features of your own data):<br />
  1. Download human protein [interaction data](https://stringdb-downloads.org/download/protein.physical.links.detailed.v11.5/9606.protein.physical.links.detailed.v11.5.txt.gz) and protein [sequence data](https://stringdb-downloads.org/download/protein.sequences.v11.5/9606.protein.sequences.v11.5.fa.gz) from the [STRING database](https://version-11-5.string-db.org/cgi/download?sessionId=bza7bKrnOz1i&species_text=Homo+sapiens). <br />
  2. Unzip the two files and put them in the `./data_prepare` folder and name them `STRING_PPI_all.txt` and `STRING_sequence.txt`, respectively.<br />
  3. Run the python script `filter_SPI.py` to obtain high quality SEP-protein interactions and corresponding sequence data.


- STEP 1: Various features are generated from sequence data of SEP and proteins. <br />
  1. Structure data of SEP and protein are generated: <br />
  If you have the structured data obtained from the database, place it in either the `./data_prepare/STRING_data/protein_PDB` folder or the `SEP_PDB` folder. If you only have sequence data, you can use [ESMFold2](https://github.com/facebookresearch/esm) [1] to computationally generate structural data and place it in the corresponding folder.
  2. [ScanNet](https://github.com/jertubiana/ScanNet) [2] technology was used to obtain the structural characteristics of SEP and proteins: <br />
  Place the pdb file in the `ScanNet/PDB` folder, place the `Fold_SPI/data_prepare/get_ScanNet_features.py` file in the ScanNet folder, and run the script `python get_ScanNet_features.py`  to obtain the structure features of SEP and proteins.
  3. [IUPred2a](https://iupred2a.elte.hu/) [3] was used to calculate the intrinsic disorder characteristics of SEP and proteins. And run the script `python intrinsic_feature.py`.<br />
  4. PSSM matrix: The PSSM matrix was generated by [BLAST](https://ftp.ncbi.nlm.nih.gov/blast/executables/blast+/LATEST/) [4] software. Build the BLAST local [database](https://ftp.ncbi.nlm.nih.gov/blast/db/swissprot.tar.gz). And run the script `python PSSM_feature.py`.


- STEP 2: Feature standardization. <br />
  Run the python script `python preprocess_features.py`.


- STEP 3: Create the dataset. <br />
  1. Using the positive sample file `filter_SPI.txt` obtained in `STEP 0`, obtain the negative sample data and build the data set. Please run the script `python interaction_to_all.py`.
  2. If you want to use the two new partitioning rules presented in the article, first use the `split_train_test.py` script to get positive samples from the training set and the test set divided according to the `split by SEP` or `split by protein` rule.The negative samples in the dataset are then supplemented by the script `interaction_to_all.py`.


- STEP 4: Train your own model: <br />
  1. Switch your working directory to the `Fold-SPI/train` folder. <br />
  2. Run the script `train.py`. Options are:<br />
  `--feature_dir FEATURE_DIR`<br />
  `--train_file TRAIN_FILE`<br />
  `--test_file TEST_FILE`<br />
  `--label_file LABEL_FILE`<br />
  `--preds_file PREDS_FILE`<br />
  3. Or run the script `train_fold.py`. Options are:<br />
  `--feature_dir FEATURE_DIR`<br />
  `--data_file DATA_FILE`<br />
  `--label_file LABEL_FILE`<br />
  `--preds_file PREDS_FILE`<br />

     
### Reference

<div id="refer-anchor-1"></div>

- [1] Lin Z, Akin H, Rao R, Hie B, Zhu Z, Lu W, Smetanin N, Verkuil R, Kabeli O, Shmueli Y, Dos Santos Costa A, Fazel-Zarandi M, Sercu T, Candido S, Rives A. Evolutionary-scale prediction of atomic-level protein structure with a language model. Science. 2023 Mar 17;379(6637):1123-1130. doi: 10.1126/science.ade2574. Epub 2023 Mar 16. PMID: 36927031.

<div id="refer-anchor-2"></div>

- [2] Tubiana, J., Schneidman-Duhovny, D. & Wolfson, H.J. ScanNet: an interpretable geometric deep learning model for structure-based protein binding site prediction. Nat Methods 19, 730–739 (2022). https://doi.org/10.1038/s41592-022-01490-7

<div id="refer-anchor-3"></div>

- [3] Mészáros, B., Erdos, G. & Dosztányi, Z. IUPred2A: context-dependent prediction of protein disorder as a function of redox state and protein binding. Nucleic Acids Res. 46, W329–W337 (2018).

<div id="refer-anchor-4"></div>

- [4] Altschul, S. F. et al. Gapped BLAST and PSI-BLAST: a new generation of protein database search programs. Nucleic Acids Res. 25, 3389–3402 (1997).


